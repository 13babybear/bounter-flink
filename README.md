# bounter-flink
Flink实时计算处理链路监控的演示程序  

### 基本思想
  通过时间窗口聚合节点数据，在一个窗口内，在内存中保存监控记录，告警处理完之后，清除窗口内存中对应的监控记录。当窗口数据全部处理完成后，如果仍然有未处理完成的监控记录，则把它持久化到Redis中，并设置TTL，超时告警。后面来的节点先去内存中找监控记录，找到直接处理；找不到再去Redis找监控记录，这样既能迅速处理正常的数据，又能保证个别异常数据不会丢失。通过这样来把原来大量的数据库I/O操作转成短时间内的内存计算，如果链路节点数据差不多在一个时间窗口到的话，能够大大减少Redis保存的数据量
### 程序输入
A-1-1-1  
B-2-1-1  
C-3-8-1  
D-4-1-1  
E-5-1-1
### 程序输出
-------开始进行窗口聚合-------  
聚合的节点：  
A  
B  
C  
D  
发出一条告警信息，告警内容：[节点数据不一致]，源节点：[A]，节点数据：[1]，目标节点：[C]，节点数据：[8]  
发出一条告警信息，告警内容：[节点数据不一致]，源节点：[C]，节 点数据：[8]，目标节点：[D]，节点数据：[1]  
窗口关闭时Redis中的监控记录：  
CE  
-------窗口聚合结束-------  
-------开始进行窗口聚合-------  
聚合的节点：  
E  
发出一条告警信息，告警内容：[节点数据不一致]，源节点：[C]，节点数据：[8]，目标节点：[E]，节点数据：[1]  
窗口关闭时Redis中的监控记录：无  
-------窗口聚合结束-------  
